<?xml version="1.0" encoding="UTF-8"?>
<shader type="fragment">
	<imports>
		<import>texture/gammacorrecttexture</import>
		<import>texture/gammacorrecttexturergb</import>
		<import>texture/albedomap</import>
		<import>texture/metallicmap</import>
		<import>texture/normalmap</import>
	</imports>
	<s_outputs>
		<output>
			<disp_name>Position</disp_name>
			<location>0</location>
			<type>FLOAT4</type>
			<name>gPosition</name>
		</output>
		<output>
			<disp_name>Albedo</disp_name>
			<location>1</location>
			<type>FLOAT4</type>
			<name>gAlebdo</name>
		</output>
		<output>
			<disp_name>Metallic</disp_name>
			<location>2</location>
			<type>FLOAT4</type>
			<name>gMetallic</name>
		</output>
		<output>
			<disp_name>Normal</disp_name>
			<location>3</location>
			<type>FLOAT4</type>
			<name>gNormal</name>
		</output>
	</s_outputs>
	<s_inputs>
		<input>
			<disp_name>Fragment In</disp_name>
			<location>0</location>
			<type>DataBlock</type>
			<name>fs_in</name>
		</input>
	</s_inputs>
	<u_inputs>
		<input>
			<disp_name>Albedo Map</disp_name>
			<location>0</location>
			<type>Texture2D</type>
			<name>u_AlbedoMap</name>
		</input>
		<input>
			<disp_name>Metallic Map</disp_name>
			<location>1</location>
			<type>Texture2D</type>
			<name>u_MetallicMap</name>
		</input>
		<input>
			<disp_name>Normal Map</disp_name>
			<location>2</location>
			<type>Texture2D</type>
			<name>u_NormalMap</name>
		</input>
		<input>
			<disp_name>Albedo Colour</disp_name>
			<location>3</location>
			<type>FLOAT4</type>
			<name>u_AlbedoColor</name>
		</input>
		<input>
			<disp_name>Metallic Colour</disp_name>
			<location>4</location>
			<type>FLOAT4</type>
			<name>u_MetallicColor</name>
		</input>
		<input>
			<disp_name>Normal Colour</disp_name>
			<location>5</location>
			<type>FLOAT3</type>
			<name>u_NormalColor</name>
		</input>
		<input>
			<disp_name>Using Albedo Map</disp_name>
			<location>6</location>
			<type>BOOL</type>
			<name>u_UsingAlbedoMap</name>
		</input>
		<input>
			<disp_name>Using Metallic Map</disp_name>
			<location>7</location>
			<type>BOOL</type>
			<name>u_UsingMetallicMap</name>
		</input>
		<input>
			<disp_name>Using Normal Map</disp_name>
			<location>8</location>
			<type>BOOL</type>
			<name>u_UsingNormalMap</name>
		</input>
	</u_inputs>
	<structs>
		<struct>
			<disp_name>Data Block</disp_name>
			<name>DataBlock</name>
			<fields>
				<field>
					<disp_name>Position</disp_name>
					<type>FLOAT4</type>
					<name>position</name>
				</field>
				<field>
					<disp_name>Normal</disp_name>
					<type>FLOAT3</type>
					<name>normal</name>
				</field>
				<field>
					<disp_name>Texture Coordinates</disp_name>
					<type>FLOAT2</type>
					<name>uv</name>
				</field>
				<field>
					<disp_name>Binormal</disp_name>
					<type>FLOAT3</type>
					<name>binormal</name>
				</field>
				<field>
					<disp_name>Tangent</disp_name>
					<type>FLOAT3</type>
					<name>tangent</name>
				</field>
			</fields>
		</struct>
		<struct>
			<disp_name>Material</disp_name>
			<name>Material</name>
			<fields>
				<field>
					<disp_name>Albedo</disp_name>
					<type>FLOAT4</type>
					<name>albedo</name>
				</field>
				<field>
					<disp_name>Metallic</disp_name>
					<type>FLOAT4</type>
					<name>metallic</name>
				</field>
			</fields>
		</struct>
		<struct>
			<disp_name>Attributes</disp_name>
			<name>Attributes</name>
			<fields>
				<field>
					<disp_name>Position</disp_name>
					<type>FLOAT3</type>
					<name>position</name>
				</field>
				<field>
					<disp_name>Normal</disp_name>
					<type>FLOAT3</type>
					<name>normal</name>
				</field>
				<field>
					<disp_name>Binormal</disp_name>
					<type>FLOAT3</type>
					<name>binormal</name>
				</field>
				<field>
					<disp_name>Tangent</disp_name>
					<type>FLOAT3</type>
					<name>tangent</name>
				</field>
			</fields>
		</struct>
	</structs>
	<fields>
		<field>
			<disp_name>Attributes</disp_name>
			<type>Attributes</type>
			<name>g_Attributes</name>
		</field>
		<field>
			<disp_name>Material</disp_name>
			<type>Material</type>
			<name>g_Material</name>
		</field>
	</fields>
	<main_instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Attributes.position</out_field>
			<call_func>
				<func_name>GetXYZ</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>fs_in.position</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Attributes.normal</out_field>
			<call_func>
				<func_name>Texture</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>u_NormalMap</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>fs_in.uv</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Attributes.normal</out_field>
			<call_func>
				<func_name>GetNormal</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>g_Attributes.normal</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>fs_in.normal</name>
						</field>
					</input>
					<input>
						<field>
							<location>2</location>
							<name>fs_in.binormal</name>
						</field>
					</input>
					<input>
						<field>
							<location>3</location>
							<name>fs_in.tangent</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Material.albedo</out_field>
			<call_func>
				<func_name>Texture</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>u_AlbedoMap</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>fs_in.uv</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Material.albedo</out_field>
			<call_func>
				<func_name>GammaCorrect</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>g_Material.albedo</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>u_Gamma</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Material.metallic</out_field>
			<call_func>
				<func_name>Texture</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>u_MetallicMap</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>fs_in.uv</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>g_Material.metallic</out_field>
			<call_func>
				<func_name>GammaCorrect</func_name>
				<inputs>
					<input>
						<field>
							<location>0</location>
							<name>g_Material.metallic</name>
						</field>
					</input>
					<input>
						<field>
							<location>1</location>
							<name>u_Gamma</name>
						</field>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>gPosition</out_field>
			<call_func>
				<func_name>MakeFloat4</func_name>
				<inputs>
					<input>
						<field>g_Attributes.position</field>
					</input>
					<input>
						<value>1.0</value>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Func</type>
			<out_field>gNormal</out_field>
			<call_func>
				<func_name>MakeFloat4</func_name>
				<inputs>
					<input>
						<field>g_Attributes.normal</field>
					</input>
					<input>
						<value>1.0</value>
					</input>
				</inputs>
			</call_func>
		</instruction>
		<instruction>
			<type>Set_By_Field</type>
			<out_field>gAlebdo</out_field>
			<field>g_Material.albedo</field>
		</instruction>
		<instruction>
			<type>Set_By_Field</type>
			<out_field>gMetallic</out_field>
			<field>g_Material.metallic</field>
		</instruction>
	</main_instruction>
</shader> 